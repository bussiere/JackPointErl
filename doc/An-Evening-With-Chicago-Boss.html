<!DOCTYPE html>
<html class=" js no-flexbox flexbox-legacy flexboxlegacy canvas canvastext webgl no-touch geolocation postmessage no-websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients no-cssreflections csstransforms csstransforms3d csstransitions fontface generatedcontent video audio localstorage sessionstorage webworkers applicationcache svg inlinesvg smil svgclippaths mozilla"><head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# githubog: http://ogp.me/ns/fb/githubog#">
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>An Evening With Chicago Boss · evanmiller/ChicagoBoss Wiki</title>
    <link rel="search" type="application/opensearchdescription+xml" href="https://github.com/opensearch.xml" title="GitHub">
    <link rel="fluid-icon" href="https://github.com/fluidicon.png" title="GitHub">
    <link rel="shortcut icon" href="https://github.com/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="https://github.com/evanmiller/ChicagoBoss/wiki/apple-touch-icon-114.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://github.com/evanmiller/ChicagoBoss/wiki/apple-touch-icon-114.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://github.com/evanmiller/ChicagoBoss/wiki/apple-touch-icon-144.png">
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://github.com/evanmiller/ChicagoBoss/wiki/apple-touch-icon-144.png">

    
    

    <meta content="authenticity_token" name="csrf-param">
<meta content="XBr0uP+Xb3Zfr+6TQHmEa9Lg2r5dPMvBcQ+aaUN5Png=" name="csrf-token">

    <link href="An-Evening-With-Chicago-Boss_files/github-c7aa8f1ff389c28b2c644b22d0160e6e36abeb39.css" media="screen" rel="stylesheet" type="text/css">
    <link href="An-Evening-With-Chicago-Boss_files/github2-bbb63b3fd6f11e65f563d57794a7ae33e8ddb4a3.css" media="screen" rel="stylesheet" type="text/css">
    
    


    <script src="An-Evening-With-Chicago-Boss_files/track.js" data-site-id="4f5634b5613f5d0429000010" id="gauges-tracker" async="" type="text/javascript"></script><script src="An-Evening-With-Chicago-Boss_files/frameworks-41bb9f3a8ce0b760dd1d2428c5727a0cec9bf9bd.js" type="text/javascript"></script>
    
    <script defer="defer" src="An-Evening-With-Chicago-Boss_files/github-c8d1a0512ce9ded7252b297b8dfe51d7294d29c4.js" type="text/javascript"></script>
    
    

      <script defer="defer" src="An-Evening-With-Chicago-Boss_files/wiki-7004cff75c69451fba79772d81491b35f0e1d342.js" type="text/javascript"></script>
    <meta property="og:title" content="ChicagoBoss">
    <meta property="og:type" content="githubog:gitrepository">
    <meta property="og:url" content="https://github.com/evanmiller/ChicagoBoss">
    <meta property="og:image" content="https://a248.e.akamai.net/assets.github.com/images/gravatars/gravatar-140.png?1329921026">
    <meta property="og:site_name" content="GitHub">
    <meta property="og:description" content="Erlang web MVC, now featuring Comet. Contribute to ChicagoBoss development by creating an account on GitHub.">

    <meta name="description" content="Erlang web MVC, now featuring Comet. Contribute to ChicagoBoss development by creating an account on GitHub.">

  <link href="https://github.com/evanmiller/ChicagoBoss/commits/master.atom" rel="alternate" title="Recent Commits to ChicagoBoss:master" type="application/atom+xml">

  <script src="An-Evening-With-Chicago-Boss_files/ga.js" async="" type="text/javascript"></script></head>


  <body class="logged_in  linux vis-public env-production  ff">
    <div id="wrapper">

    
    
    <div class="global-notice"><h2>We are having a problem billing your credit card. Please <a href="https://github.com/account/billing">enter a new card</a> or contact <a href="mailto:support@github.com">support@github.com</a> for questions.</h2><p>Your private repositories have been locked until you fix this error. Thanks for understanding.</p></div>

      <div id="header" class="true clearfix">
        <div class="container clearfix">
          <a class="site-logo" href="https://github.com/">
            <!--[if IE]>
            <img alt="GitHub" class="github-logo" src="https://a248.e.akamai.net/assets.github.com/images/modules/header/logov7.png?1329921026" />
            <img alt="GitHub" class="github-logo-hover" src="https://a248.e.akamai.net/assets.github.com/images/modules/header/logov7-hover.png?1329921026" />
            <![endif]-->
            <img alt="GitHub" class="github-logo-4x" src="An-Evening-With-Chicago-Boss_files/logov74x.png" height="30">
            <img alt="GitHub" class="github-logo-4x-hover" src="An-Evening-With-Chicago-Boss_files/logov74x-hover.png" height="30">
          </a>


              
    <div class="topsearch  ">
        <form accept-charset="UTF-8" action="/search" id="top_search_form" method="get">
  <a original-title="Advanced Search" href="https://github.com/search" class="advanced-search tooltipped downwards"><span class="mini-icon mini-icon-advanced-search"></span></a>
  <div class="search placeholder-field js-placeholder-field">
    <input class="search my_repos_autocompleter" id="global-search-field" name="q" results="5" spellcheck="false" autocomplete="off" data-autocomplete="my-repos-autocomplete" placeholder="Search…" data-hotkey="s" type="text">
    <div id="my-repos-autocomplete" class="autocomplete-results">
      <ul class="js-navigation-container"></ul>
    </div>
    <input value="Search" class="button" type="submit">
    <span class="mini-icon mini-icon-search-input"></span>
  </div>
  <input name="type" value="Everything" type="hidden">
  <input name="repo" value="" type="hidden">
  <input name="langOverride" value="" type="hidden">
  <input name="start_value" value="1" type="hidden">
</form>

      <ul class="top-nav">
          <li class="explore"><a href="https://github.com/explore">Explore</a></li>
          <li><a href="https://gist.github.com/">Gist</a></li>
          <li><a href="https://github.com/blog">Blog</a></li>
        <li><a href="http://help.github.com/">Help</a></li>
      </ul>
    </div>


            


  <div id="userbox">
    <div id="user">
      <a href="https://github.com/bussiere"><img src="An-Evening-With-Chicago-Boss_files/590ab8e31e515d6d8666c8b81f3a1317.jpeg" height="20" width="20"></a>
      <a href="https://github.com/bussiere" class="name">bussiere</a>
    </div>
    <ul id="user-links">
      <li>
        <a original-title="Create a New Repo" href="https://github.com/new" id="new_repo" class="tooltipped downwards"><span class="mini-icon mini-icon-create"></span></a>
      </li>
      <li>
        <a original-title="Notifications" href="https://github.com/inbox/notifications" id="notifications" class="tooltipped downwards">
          <span class="mini-icon mini-icon-notifications"></span>
        </a>
      </li>
      <li>
        <a original-title="Account Settings " href="https://github.com/settings/profile" id="account_settings" class="tooltipped downwards">
          <span class="mini-icon mini-icon-account-settings"></span>
        </a>
      </li>
      <li>
          <a original-title="Sign Out" href="https://github.com/logout" data-method="post" id="logout" class="tooltipped downwards">
            <span class="mini-icon mini-icon-logout"></span>
          </a>
      </li>
    </ul>
  </div>



          
        </div>
      </div>

      

            <div class="site hfeed" itemscope="" itemtype="http://schema.org/WebPage">
      <div class="container hentry">
        <div class="pagehead repohead instapaper_ignore readability-menu">
        <div class="title-actions-bar">
          



              <ul class="pagehead-actions">




          <li class="js-toggler-container js-social-container watch-button-container on">
            <span class="watch-button"><a href="https://github.com/evanmiller/ChicagoBoss/toggle_watch" class="minibutton btn-watch js-toggler-target lighter" data-remote="true" data-method="post" rel="nofollow">Watch</a><a class="social-count js-social-count" href="https://github.com/evanmiller/ChicagoBoss/watchers">393</a></span>
            <span class="unwatch-button"><a href="https://github.com/evanmiller/ChicagoBoss/toggle_watch" class="minibutton btn-unwatch js-toggler-target lighter" data-remote="true" data-method="post" rel="nofollow">Unwatch</a><a class="social-count js-social-count" href="https://github.com/evanmiller/ChicagoBoss/watchers">393</a></span>
          </li>

              <li>
                <a href="https://github.com/bussiere/ChicagoBoss" class="minibutton btn-fork js-toggler-target lighter" rel="nofollow">Your Fork</a><a href="https://github.com/evanmiller/ChicagoBoss/network" class="social-count">70</a>
              </li>


    </ul>

          <h1 itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb" class="entry-title public">
            <span class="repo-label"><span>public</span></span>
            <span class="mega-icon mega-icon-public-repo"></span>
            <span class="author vcard">
<a href="https://github.com/evanmiller" class="url fn" itemprop="url" rel="author">              <span itemprop="title">evanmiller</span>
              </a></span> /
            <strong><a href="https://github.com/evanmiller/ChicagoBoss" class="js-current-repository">ChicagoBoss</a></strong>
          </h1>
        </div>

          

  <ul class="tabs">
    <li><a href="https://github.com/evanmiller/ChicagoBoss" highlight="repo_sourcerepo_downloadsrepo_commitsrepo_tagsrepo_branches">Code</a></li>
    <li><a href="https://github.com/evanmiller/ChicagoBoss/network" highlight="repo_network">Network</a>
    </li><li><a href="https://github.com/evanmiller/ChicagoBoss/pulls" highlight="repo_pulls">Pull Requests <span class="counter">6</span></a></li>

      <li><a href="https://github.com/evanmiller/ChicagoBoss/issues" highlight="repo_issues">Issues <span class="counter">21</span></a></li>

      <li><a href="https://github.com/evanmiller/ChicagoBoss/wiki" class="selected" highlight="repo_wiki">Wiki</a></li>

    <li><a href="https://github.com/evanmiller/ChicagoBoss/graphs" highlight="repo_graphsrepo_contributors">Graphs</a></li>

  </ul>
  
  
  
  <div class="subnav-bar">
  <ul class="subnav">
    <li><a href="https://github.com/evanmiller/ChicagoBoss/wiki">Home</a></li>
    <li><a href="https://github.com/evanmiller/ChicagoBoss/wiki/_pages">Pages</a></li>
    <li><a href="https://github.com/evanmiller/ChicagoBoss/wiki/_history">Wiki History</a></li>
    <li><a href="https://github.com/evanmiller/ChicagoBoss/wiki/_access">Git Access</a></li>
  </ul>
</div>


          

        </div><!-- /.repohead -->

        <div id="js-repo-pjax-container" data-pjax-container="">
          



<div id="wiki-wrapper" class="page">
<div id="head">
  <h1 class="instapaper_title">An Evening With Chicago Boss</h1>
  <ul class="wiki-actions readability-extra">
    <li class="gollum-minibutton">
      <a href="https://github.com/evanmiller/ChicagoBoss/wiki/_new" class="minibutton btn-new-page bigger js-new-wiki-page">New Page</a>
    </li>
    <li class="gollum-minibutton"><a href="https://github.com/evanmiller/ChicagoBoss/wiki/An-Evening-With-Chicago-Boss/_edit" class="minibutton bigger action-edit-page">
       Edit Page
     </a></li>
    <li class="gollum-minibutton"><a href="https://github.com/evanmiller/ChicagoBoss/wiki/An-Evening-With-Chicago-Boss/_history" class="minibutton bigger action-page-history">
       Page History
     </a></li>
  </ul>
</div>
<div id="wiki-content">
  <div class="wrap">
  <div id="wiki-body" class="gollum-textile-content instapaper_body">
    <div class="markdown-body">
      <h1>An Evening With Chicago Boss</h1>
<p>By <a href="http://www.evanmiller.org/">Evan Miller</a></p>
<h2>Part I. Introduction</h2>
<p>I wrote a web framework for Erlang called <a href="http://www.chicagoboss.org/">Chicago Boss</a>. This guide will show you how to use it to write a simple web application, complete with logins and an <span class="caps">RSS</span> feed.</p>
<div class="quote">
    <p>“Well, what’s in it for me?” —You</p>
</div>
<p>Chicago Boss gives you a high-performance database that scales, an advanced <span class="caps">ORM</span>,
 fast Django templates, clean pattern-matching controllers, automatic 
code reloading, auto-generated documentation for your models, a clunky 
but very useful admin interface, and an innovative functional test 
framework, all right out of the box. If you choose to use Boss, your 
development cycles will be fast, your code will be clean, and your 
servers will be grateful.</p>
<p>If you’re new to Erlang and curious about what makes Chicago Boss fast, check out <a href="http://www.evanmiller.org/chicago-boss-secret.html">Chicago Boss’s Big Secret</a>.
 If you don’t care about whys and just want to get behind the wheel, 
read on. If you have any questions or find any errors, feel free to <a href="http://groups.google.com/group/chicagoboss">check out the mailing list</a> or just send me an email personally, emmiller@gmail.com.</p>
<p>Let’s get started!</p>
<h2>Part II. Building With Boss</h2>
<div class="quote">
<p>“You leave the thinkin’ to me.” —Boss</p>
</div>
<h3>II.0. Table of Contents</h3>
<p>Here’s the roadmap, pilgrim:</p>
<ol>
<li><a href="#wiki-learning-erlang">Learning Erlang</a></li>
    <li><a href="#wiki-installing-erlang">Installing Erlang</a></li>
    <li><a href="#wiki-my-first-boss">My First Boss</a></li>
    <li><a href="#wiki-essential-tricks">Essential Tricks: /admin and /doc</a></li>
    <li><a href="#wiki-model-view-controller">Model, View and Controller</a></li>
<ol>
<li><a href="#wiki-model">Model</a></li>
        <li><a href="#wiki-view">View</a></li>
        <li><a href="#wiki-controller">Controller</a></li>
        <li><a href="#wiki-all-together">All Together Now</a></li>
</ol>
<li><a href="#wiki-associations">Associations: belongs_to and has</a></li>
    <li><a href="#wiki-logins">How To Implement Log-ins</a></li>
    <li><a href="#wiki-login-info">How To Actually Use Log-In Information</a></li>
    <li><a href="#wiki-validate">How To Validate Input</a></li>
    <li><a href="#wiki-logout">How To Implement A Log-Out</a></li>
    <li><a href="#wiki-rss-feed">How To Implement an <span class="caps">RSS</span> feed</a></li>
</ol><p><a name="wiki-learning-erlang"></a><br></p><h3>II.1. Learning Erlang</h3>
<p><em>Learn Erlang if you don’t know it.</em> You can try to pick up on
 Erlang syntax by reading the examples in the rest of this article, but 
if you want to build things, you’ll need to get acquainted with a good 
Erlang reference. I recommend the book <a href="http://pragprog.com/titles/jaerlang/programming-erlang"><em>Programming Erlang</em></a> by Joe Armstrong. If you buy the <span class="caps">PDF</span>,
 you can even start reading it today. Here, I’ll even tell you the parts
 you can skip if you just want to start building things with Boss as 
soon as possible:</p>
<p><em>Read</em>: Chapter 2, Chapter 3 (skip 3.9 Records), Chapter 5 (skip 5.2 Binaries and 5.3 Bit Syntax).<br><br></p><p>Those
 3 chapters have 99% of what you need. Read Chapter 4 (Exceptions) once 
you’ve built a few things and need extra robustness. But otherwise, you 
don’t need to worry about compiling, concurrency, the process model, 
server loops, or any of the other things Erlang is celebrated for. Boss 
takes care of it.</p>
<p>An alternative book is free on the web: <em><a href="http://learnyousomeerlang.com/">Learn You Some Erlang For Great Good!</a></em> I haven’t read it but it looks entertaining.</p>
<p><a name="wiki-installing-erlang"></a><br></p><h3>II.2. Installing Erlang</h3>
<p>Chapter 2 of the Armstrong book explains how to download and install Erlang. Here’s the gist of it:</p>
<p><em>Linux (Debian/Ubuntu):</em></p>

<pre>sudo apt-get install erlang
</pre>
<p>or (RedHat, CentOS, Fedora):</p>
<pre>su -c 'yum install erlang'
</pre>
<p><em>Mac:</em></p>
<p>Using <a href="http://mxcl.github.com/homebrew/">Homebrew</a>:</p>

<pre>brew install erlang
</pre>
<p>Using <a href="http://www.macports.org/">MacPorts</a> (with the <code>+ssl</code> option),:</p>

<pre>port install erlang +ssl
</pre>
<p>From source:</p>
<p>There are several configurations to install from source on mac. It’s 
probably best to read through the instructions available on the Basho 
page: <a href="http://wiki.basho.com/Installing-Erlang.html">Installing Erlang</a> especially for those on 10.7</p>
<p><em>Windows:</em></p>
<p>Chicago Boss works on Windows when you follow <a href="https://github.com/evanmiller/ChicagoBoss/wiki/Windows-instructions">Windows instructions</a>. </p>
<h3>II.3. Database options</h3>
<p>For this tutorial, we’ll use an in-memory database, so there’s nothing to install. When you want to get serious, check out <a href="#wiki-meet-tyrant">Appendix A: Meet The Tyrant</a>. For a list of all available databases, visit GitHub repository of <a href="https://github.com/evanmiller/boss_db/tree/master/src/db_adapters">Boss DB adapters</a>.</p>
<p><a name="wiki-my-first-boss"></a><br></p><h3>II.4. My First Boss</h3>
<p>We’re finally ready to have some fun. First, download Chicago Boss, untar, and cd:</p>

<pre>wget https://github.com/downloads/evanmiller/ChicagoBoss/ChicagoBoss-0.7.2.tar.gz
tar xzf ChicagoBoss-0.7.2.tar.gz
cd ChicagoBoss-0.7.2
</pre>
<p>The way things are in Chicago Boss 0.7.2 is that you need to build 
Chicago Boss first and then create a new project that will host your 
code.</p>
<p>To build Chicago Boss and create a new project:</p>

<pre>make
make app PROJECT=evening
</pre>
<p>Now change directory into the new projects and start it (there will be a lot of <span class="caps">PROGRESS</span> <span class="caps">REPORTS</span> flying by on your terminal but hopefully there is no big scary error messages):</p>
<pre>cd ../evening
./init-dev.sh
</pre>
<p>Open http://localhost:8001/ in your browser and you should see a message: No routes matched the requested <span class="caps">URL</span>…</p>
<p>(Obviously, if you’re running Boss on another machine, change <span class="code">localhost</span> to the name of that machine.)</p>
<p>The terminal with the <span class="caps">PROGRESS</span> REPORTs is 
actually a shell that has direct access to the server. In this shell, 
you can type in any Erlang command, interact with the database, and use 
the full Boss <span class="caps">API</span>. It’s pretty convenient, and it’s a good place to learn a few commands.</p>
<p>Let’s create a hello world message which we later will update to show
 a different greeting from a database. Put this into 
src/controller/evening_greeting_controller.erl</p>

<pre>-module(evening_greeting_controller, [Req]).
-compile(export_all).

index('GET', []) -&gt;
    {output, "&lt;strong&gt;Hello World!&lt;/strong&gt;"}.
</pre>
<p>After you save the controller, run ./rebar compile and open http://localhost:8001/greeting/index</p>
<p>Create model for greetings in src/model/greeting.erl</p>

<pre>-module(greeting, [Id, GreetingText]).
-compile(export_all).
</pre>
<p>Open http://localhost:8001/doc/greeting to see list of functions that the framework provides for all your models of the box.</p>
<p>Right now, you do not have greetings created and if you type in the shell with all the <span class="caps">PROGRESS</span> REPORTs a command to fetch all greetings and assign them to a variable, your result will be an empty Erlang list.</p>

<pre>1&gt; InitialGreetings = boss_db:find(greeting, []).
</pre>
<p>That command searches the database for greetings that match the 
search criteria. In the second argument we’ve specified an empty list of
 search criteria, so it should search for all greetings. The command 
should return something like this:</p>

<pre>[]
</pre>
<p>because there are no greetings in the database. Let’s create one greeting and save it to the database.</p>
<pre>2&gt; FirstGreeting = greeting:new(id, "Boss says Hello!").
{greeting,id,"Boss says Hello!"}
3&gt; FirstGreeting:save().
{ok, {greeting, "greeting-1", "Boss says Hello!"}}
</pre>
<p>What you see there is a list with a single BossRecord. A BossRecord 
looks like an ordinary tuple, but it has special powers. First let’s get
 the BossRecord out of the list of our saved greetings:</p>

<pre>4&gt; Saved = boss_db:find(greeting, []).
[{greeting,"greeting-1","Hello"}].
5&gt; Greeting = hd(Saved). % Pop the only BossRecord off the list
{greeting,"greeting-1","Boss says Hello!"}
</pre>
<p>Now let’s invoke some powers:</p>

<pre>6&gt; Greeting:attribute_names().
[id, greeting_text]
</pre>
<p>The function <span class="code">attribute_names</span> returns a list
 of the BossRecord’s attributes. These attributes are an essential 
aspect of programming with Chicago Boss; think of them as database 
columns or text fields. We will define a list of attributes for every 
data model in our project. Here we see that the greeting model only has 
two attributes (<span class="code">id</span> and <span class="code">greeting_text</span>), and we can access them with individual function calls like this:</p>

<pre>7&gt; Greeting:greeting_text().
"Boss says Hello!"
8&gt; Greeting:id().
"greeting-1"
</pre>
<p>The <span class="code">id</span> attribute is special. It belongs to 
all BossRecords and its values are unique. We’ll see that IDs are 
automatically generated and are always prefixed with the object type 
(e.g. “greeting-”). It’s not that important, but the ID <em>number</em> 
is also unique, so that if there’s a greeting-1, there will not be a 
user-1, and if there’s a user-42, there will not be a greeting-42.</p>
<p>Anyway, BossRecords also come with setter functions. Recall that 
Erlang is a single-assignment language, so if we change the BossRecord, 
we need to assign it to a new variable. Let’s try changing the message:</p>

<pre>9&gt; NewGreeting = Greeting:set(greeting_text, "Do I look like Santa Claus?").
{greeting,"greeting-1","Do I look like Santa Claus?"}
</pre>
<p>Now let’s update the controller to show the greeting that we just saved using the same commands that we typed in the console.</p>

<pre>-module(evening_greeting_controller, [Req]).
-compile(export_all).

index('GET', []) -&gt;
    SavedGreetings = boss_db:find(greeting, []),
    FirstGreeting = hd(SavedGreetings),
    {output, FirstGreeting:greeting_text()}.
</pre>
<p>Now go back to your web browser and open <span class="caps">URL</span> to execute the controller. Do you see the new message “Do I look like Santa Clause?” message?</p>
<p>You shouldn’t. We still need to save the changes we’ve made to the database. Saving can be accomplished with the <b>save()</b> function:</p>

<pre>10&gt; NewGreeting:save().
{ok, {greeting,"greeting-2", "Do I look like Santa Claus?"}}
</pre>
<p>Now go back to your web browser and refresh. Tada!</p>
<p>Next, let’s add another greeting to the database. We use the <b>greeting:new/2</b> function to create a greeting:</p>

<pre>11&gt; MyGreeting = greeting:new(id, "Where's mine?").
{greeting, id, "Where's mine?"}
</pre>
<p>Recall that the greeting model has two attributes: <b>id</b> and <b>greeting_text</b>. The <b>new</b> function is always invoked with a value for each attribute: no more, no less. <em>The attribute order is important!</em>
 It’s defined in the model file, which we’ll get to in a few minutes. 
For now, let’s make sure we got the order right. Check the <b>id</b>:</p>

<pre>12&gt; MyGreeting:id().
id
</pre>
<p>And the <b>greeting_text</b>:</p>

<pre>13&gt; MyGreeting:greeting_text().
"Where's mine?"
</pre>
<p>Looks OK. Notice that we passed in the atom <b>id</b> instead of an 
ID string. That tells Boss that we want the ID to be generated for us. 
The ID will be generated as soon as we save the BossRecord:</p>

<pre>14&gt; {ok, SavedGreeting} = MyGreeting:save().
{ok, {greeting, "greeting-2", "Where's mine?"}}
</pre>
<p>The ID is always in the second position, but we can access it with the getter function too:</p>

<pre>15&gt; SavedGreeting:id().
"greeting-2"
</pre>
<p>Since the new greeting has an ID, we know for sure it’s in the database. Let’s prove it:</p>

<pre>16&gt; boss_db:find(greeting, []).
[{greeting,"greeting-1","Do I look like Santa Claus?"},
 {greeting,"greeting-2","Boss says Hello!"},
 {greeting,"greeting-3","Where's mine?"}]

</pre>
 <p>So far we’ve been pulling things out of the database by executing 
searches. But if we know the ID, we can just pull that one record. Let’s
 try it, just for kicks:</p>

<pre>17&gt; boss_db:find("greeting-1").
{greeting, "greeting-1", "Do I look like Santa Claus?"}
</pre>
<p>That function (<b>boss_db:find/1</b>) is probably the function you’ll
 use more than any other in Chicago Boss programming, so get to know it 
well. Fortunately it’s pretty easy: just pass in the ID as a string. If 
you want to make sure the ID corresponds to the model you think it does,
 just use the <b>boss_db:type/1</b> function:</p>

<pre>18&gt; boss_db:type("greeting-1").
greeting
</pre>
<p>That comes in handy for defensive programming. (The <span class="code">type</span> function isn’t completely trivial, it returns <b>undefined</b> if there’s no record with that ID in the database.)</p>
<p>Hey, did you realize that we’ve already covered the <b>C</b> as in Create, the <b>R</b> as in Read, and the <b>U</b> as in Update of <b><span class="caps">CRUD</span></b>? All that’s left is <b>D</b> as in Delete! Let’s kill the first greeting that we created:</p>

<pre>19&gt; boss_db:delete("greeting-1").
ok
</pre>
<p>And to prove it’s not in the database any longer:</p>

<pre>20&gt; boss_db:find(greeting, []).
[{greeting,"greeting-2","Boss says Hello!"},
 {greeting,"greeting-3","Where's mine?"}]

</pre>
<p>A shorter way to check how many items are in the database is the <span class="code">boss_db:count/1</span> function. It takes the model type as the only argument:</p>

<pre>21&gt; boss_db:count(greeting).
1
</pre>
<p>There’s another version, <span class="code">boss_db:count/2</span>, which takes a list of search criteria as the second argument. <span class="code">count</span> performs fewer database queries than <span class="code">find</span>, but with Chicago Boss, this difference isn’t a big deal.</p>
<p><a name="wiki-essential-tricks"></a><br></p><h3>II.5. Essential Tricks: /admin and /doc</h3>
<p>Before we start writing a program, I’m going to let you in on a couple of tricks that will help you along the way.</p>
<p>The first is the <span class="code">/admin</span> interface. <span class="code">/admin</span>
 lets you do the same things we were doing in the shell, but through a 
web interface. It used to be included by default with every ChicagoBoss 
installation and now it comes as a separate application that can be 
installed along side ChicagoBoss.</p>
<p>Download ChicagoBoss Administration application from GitHub 
https://github.com/evanmiller/cb_admin to reside in the same parent 
directory that ChicagoBoss and “evening” source code is:</p>
<p>
</p><p>|-ChicagoBoss<br>
|-evening<br>
|-cb_admin<br></p>

<pre>git clone git://github.com/evanmiller/cb_admin.git
cd cb_admin
./rebar compile
</pre>
<p>Update evening/boss.config for the “evening” application to let 
ChicagoBoss framework know that when you start the “evening” 
application, cb_admin application also needs to be started.</p>

<pre>[{boss, [
    {path, "../ChicagoBoss"},
    {vm_cookie, "abc123"},
    {applications, [evening, cb_admin]},
    {db_host, "localhost"},
    {db_port, 1978},
    {db_adapter, mock},
    {log_dir, "log"},
    {server, mochiweb},
    {port, 8001},
    {session_adapter, mock},
    {session_key, "_boss_session"},
    {session_exp_time, 525600}
]},
{ evening, [
    {path, "../evening"},
    {base_url, "/"}
]},
{cb_admin, [
    {path, "../cb_admin"},
    {allow_ip_blocks, ["127.0.0.1"]},
    {base_url, "/admin"}
]}
].
</pre>
<p>If the evening application is running in an Erlang console, shut it 
down with Ctrl+D and start it back up using ./start-dev and it will use 
the information about cb_admin from the updated boss.config. Once the 
“evening” application starts, point your browser to <a href="http://localhost:8001/admin">http://localhost:8001/admin</a></p>
<p>Click on Models tab and then “greeting” to check it out. With <span class="code">/admin</span> you can</p>
<ul>
<li>See a list of records in the database</li>
    <li>View an individual record and all its associated records</li>
    <li>Create a new record</li>
    <li>Delete a record</li>
</ul><p>The interface is helpful for debugging and is also helpful if 
you don’t feel like writing an interface for features that only site 
administrators see. The <span class="code">/admin</span> interface is 
pretty clunky at the moment, but if you want to improve it, you will 
earn the accolades of Chicago Boss developers everywhere!</p>
<p>By default, <span class="code">/admin</span> is accessible only from the local machine. If you want to change that, you will have to modify the logic at the top of <span class="code"><span class="caps">ADMIN</span>/admin_controller.erl</span>. For now, it should be fine as is.</p>
<p>The second trick to know is called <span class="code">/doc</span>. 
Remember how I said that BossRecords are parameterized modules with 
special powers? Unlike regular Erlang modules, they get compiled with a 
lot of extra features that you don’t have to write yourself: getter 
functions, setter functions, the <span class="code">save/0</span> 
function, and so on. (Note that the standard Erlang compiler doesn’t 
support inheritance; these add-on functions are a huge win for Chicago 
Boss and set it apart from other Erlang frameworks.)</p>
<p>To see all of the generated functions that your model has (plus any functions you wrote), just point your browser to</p>
<p><code>http://localhost:8001/doc/modelname</code></p>
<p>(e.g., <span class="code">/doc/greeting</span>)</p>
<p>Not only will you see documentation for all functions, but you’ll 
also find the all-important ordered attribute list in big letters at the
 top. You’ll probably consult that list whenever you call the <span class="code">new</span> function, so get used to typing <span class="code">/doc</span> into your browser.</p>
<p>With these tools in hand, you should be itching to hammer out some code.</p>
<p><a name="wiki-model-view-controller"></a><br></p><h3>II.6. Model, View, and Controller</h3>
<p>In the interest of simplicity, I’m going to show you how to build a 
simple app that shows a list of records and displays an individual 
record. We’ll cheat and use the <span class="code">/admin</span> 
interface to populate the database, but by the end of this guide you 
should be able to write your own pages for creating, updating, and 
deleting records, complete with user authentication and input 
validation. Heck we’ll even make an <span class="caps">RSS</span> feed before the evening is over. Let’s get started!</p>
<p>You should have a terminal open with the active server shell. Keep it
 open, and use another terminal (or your favorite text editor) to edit 
text files. If you accidentally closed the shell just type in <span class="code">./<span class="caps">START</span>-<span class="caps">DEV</span>.SH</span> again in the ChicagoBoss directory.</p>
<p><a name="wiki-model"></a><br></p><h4>II.6.1. Model</h4>
<p>The first thing we’ll do is create a model file. Model files will be 
turned into those mystical BossRecords that make Boss programming such a
 breeze. In true Chicago style, our example app will be a database of 
voters. Open up a new file called <span class="code">model/voter.erl</span>, and type these lines into it:</p>

<pre>-module(voter, [Id, FirstName, LastName, Address, Notes]).
-compile(export_all).
</pre>
<p>That’s all we need for now. Save and close. Point your browser to <span class="code">/doc</span> to see what we created:</p>
<p><code>http://localhost:8001/doc/voter</code></p>
<p>You’ll see the parameter list we defined in bold letters at the top. Note that <span class="code">Id</span> always has to be the first parameter.</p>
<p>Also note that we already have getter and setter functions called <span class="code">id</span>, <span class="code">first_name</span>, <span class="code">last_name</span>, <span class="code">address</span>, and <span class="code">notes</span>. Chicago Boss converts each CamelCase parameter name to its underscored equivalent for these attribute functions.</p>
<div class="aside">Parameters that end with <span class="code">Id</span> or <span class="code">Time</span> have special meaning, which we’ll discuss later.</div>
<p>If you choose to go off and write your own functions inside the model
 file, they’ll have access to all of these functions, and they’ll also 
have access to the parameter variables directly (<span class="code">Id</span>, <span class="code">FirstName</span>, and so forth). For now, we don’t need to write our own functions.</p>
<p>Next we want to populate the database with some voters. Point your browser to</p>
<p><code>http://localhost:8001/admin/model/voter</code></p>
<p>Click the button labeled “+ New voter” and fill out some dummy 
values, and then click “Create voter.” It should show you a page like 
this:</p>
<div class="figure">
<p><img src="An-Evening-With-Chicago-Boss_files/687474703a2f2f7777772e6576616e6d696c6c65722e6f72672f696d6167.png"></p>
</div>
<p>Click “Back to the voter list” and repeat until you have two or three voters in the database.</p>
<p><a name="wiki-view"></a><br></p><h4>II.6.2. View</h4>
<p>Now let’s build a little interface of our own. Create a directory in <span class="code">View</span> called <span class="code">voter</span>, and open up a new file called <span class="code">view/voter/list.html</span>.<br><br></p><p>This file will be a template written in the <a href="http://www.djangoproject.com/documentation/0.96/templates/">Django Template Language</a>. Let’s put a dumb little list into our template:</p>

<pre>&lt;ol&gt;
{% for voter in voters %}
&lt;li&gt;{{ voter.first_name }} {{ voter.last_name }} - {{ voter.address }}&lt;/li&gt;
{% endfor %}
&lt;/ol&gt;
</pre>
<p>We’re not winning any design awards, but hey. Note that variables in 
the template have complete access to BossRecord attributes with the 
simple dot notation. Under the hood it’s calling the getter functions, 
so we need to use the underscore form rather than the CamelCase names. 
Anyhow, save and close.</p>
<p><a name="wiki-controller"></a><br></p><h4>II.6.3. Controller</h4>
<p>Now all we need is some glue code: the controller. Open up a new file called <span class="code">controller/voter_controller.erl</span> and put the following lines into it:</p>

<pre>-module(voter_controller, [Req]).
-compile(export_all).

list('GET', []) -&gt;
    Voters = boss_db:find(voter, []),
    {ok, [{voters, Voters}]}.
</pre>
    <p>Let’s talk about each of these lines in order:</p>

<pre>-module(voter_controller, [Req]).
</pre>
<p>Controllers are parameterized modules that take a single parameter called <span class="code">Req</span>. <span class="code">Req</span> is a <a href="http://github.com/rklophaus/SimpleBridge">SimpleBridge <span class="caps">HTTP</span> Request Object</a> that gives us access to useful stuff like <span class="caps">POST</span> parameters, cookies, headers, etc. We don’t need <span class="code">Req</span> in this example but it will come in mega-handy later on.</p>

<pre>-compile(export_all).
</pre>
<p>(So Chicago Boss can actually access our controller functions.)</p>

<pre>list('GET', []) -&gt;
</pre>
<p>Each action is associated with a function of the same name. The 
function takes two arguments (or three, if you choose to implement 
log-ins, <a href="#wiki-logins">see below</a>). The first argument is the <span class="caps">HTTP</span>
 request method, passed as an atom. As we’ll see later on, this is 
especially powerful in conjunction with Erlang’s pattern-matching. The 
second argument is a list of tokens in the <span class="caps">URL</span> beyond the controller name and action name; this is how we get “pretty” URLs without needing a separate <span class="caps">URL</span>
 routing file. This token list is also powerful in conjunction with 
Erlang’s pattern-matching, but for now, the token list is empty.</p>

<pre>Voters = boss_db:find(voter, []),
</pre>
<p>Look familiar? This is exactly what we did in the Chicago Boss shell.</p>

<pre>{ok, [{voters, Voters}]}.
</pre>
<p>To render the associated template, the controller function needs to return <span class="code">{ok, Variables}</span>, where <span class="code">Variables</span> is a proplist that gets passed to the template file. You can return other values in order to perform a redirect, set <span class="caps">HTTP</span> headers, or report an error. We’ll get to some of those, or you can read about controller return values in the <a href="http://www.chicagoboss.org/api.html">Chicago Boss <span class="caps">API</span> docs</a>. For now, we just want a single variable called “voters” which will contain the list we get from the database.</p>
<p><a name="wiki-all-together"></a><br></p><h4>II.6.4. All Together Now</h4>
<p>And… that’s it! Point your browser to see your very first app in action:</p>

<pre>http://localhost:8001/voter/list</pre>
<p>You should see your list of voters and their addresses. Cool, huh?</p>
<p>Whoever thought a telecom programming platform could be this easy? We have a fully functioning feature with only</p>
<ul>
<li>2 lines of Model code</li>
    <li>5 lines of View code</li>
    <li>5 lines of Controller code</li>
</ul><p>Now let’s have a little more fun. Let’s make a page for viewing our Notes on each voter. Start by modifying the list template, <span class="code">view/voter/list.html</span>. Change Line 3 to have a link, like this:</p>

<pre>&lt;li&gt;&lt;a href="/voter/view/{{ voter.id }}"&gt;{{ voter.first_name }} {{ voter.last_name }}&lt;/a&gt;
</pre>
<p>Now open a new file called <span class="code">view/voter/view.html</span>, and put this into it:</p>
<pre>&lt;h1&gt;{{ voter.first_name }} {{ voter.last_name }}&lt;/h1&gt;
&lt;b&gt;Address&lt;/b&gt;&lt;br /&gt;
{{ voter.address|linebreaksbr }}&lt;br /&gt;

&lt;b&gt;Notes&lt;/b&gt;&lt;br /&gt;
{{ voter.notes|linebreaksbr }}&lt;br /&gt;

&lt;a href="/voter/list"&gt;Back to the voter list&lt;/a&gt;
</pre>
<p>Here we’re applying Django’s <span class="code">linebreaksbr</span> filter to the Notes and Address, which just adds <span class="caps">HTML</span> breaks in the appropriate places.</p>
<p>All that’s left is the controller glue. Add this function to the end of <span class="code">voter_controller.erl</span>:</p>

<pre>view('GET', [VoterId]) -&gt;
    Voter = boss_db:find(VoterId),
    {ok, [{voter, Voter}]}.
</pre>
    <p>Remember how I said the second argument is a list of <span class="caps">URL</span> tokens? That means if the requestsd <span class="caps">URL</span> is <span class="code">/voter/view/voter-5</span>, then the <span class="code">voter</span> controller is called with the <span class="code">view</span> action and <span class="code">[“voter-5”]</span> is passed in as the token list. That makes our controller function quite simple, as you can see. Here we’re just using the <span class="code">boss_db:find/1</span> function, which we saw previously in the Chicago Boss shell (and which I warned you we’d be seeing a lot of!).</p>
    <p>That’s all there is to our second feature. Point your browser to:</p>
<p><code>http://localhost:8001/voter/list</code></p>
    <p>Click on a voter and voila! There are your notes! Two features in what, 20 minutes?</p>
    <p>At this point you might be wondering how to deal with user input.
 User input usually needs to be owned by a user, so first we’re going to
 take a little detour and learn about associations, which lets one 
record belong to another. Don’t worry, the detour is short, won’t take 
but a few minutes of your time. Then we’re going to write a little 
log-in system, which will get your feet wet with processing <span class="caps">POST</span>
 data and also acquaint you with Boss’s authentication conventions. 
After that we’ll make a submission form and learn how to validate it, 
and as a final sendoff we’ll build an <span class="caps">RSS</span> feed to show you how to muck with date formatting and <span class="caps">HTTP</span> headers… because, hey, why not?</p>
<a name="wiki-associations"></a>
    <h3>II.7. Associations: belongs_to and has</h3>
    <p>A web app of any substance will have records that refer to each 
other: books belong to users, comments belong to blog posts, and so on. 
These relationships will be defined in our model files. Let’s dive in 
and see exactly how Boss does it.</p>
    <p>For our application, we’re going to make voters belong to Ward Bosses. Open up <span class="code">model/voter.erl</span> and add an attribute called <span class="code">WardBossId</span> which will tell us which Ward Boss a voter belongs to. The file should end up looking like this:</p>

<pre>-module(voter, [Id, FirstName, LastName, Address, Notes, WardBossId]).
-compile(export_all).
</pre>
<p>Save but don’t close. Just for kicks, go open the voter <span class="code">/doc</span> page,</p>

<pre>http://localhost:8001/doc/voter</pre>
<p>It should look the same as before, but now there’s an <span class="code">WardBossId</span> attribute as well as <span class="code">ward_boss_id</span> getter and setter functions.</p>
<p>Now let’s add some magic. Add the following line to <span class="code">model/voter.erl</span>:</p>

<pre>-belongs_to(ward_boss).
</pre>
<p>Save and close, then refresh the <span class="code">/doc</span> page. Notice something new?</p>
<p><code>ward_boss() -&gt; WardBoss</code></p>
<p>“Retrieves the ward_boss with Id equal to the WardBossId of this voter”</p>
<p>This <span class="code">-belongs_to</span> line creates a function that gives us direct access to the voter’s <span class="code">WardBoss</span>. Under the hood it just calls <span class="code">boss_db:find/1</span> on the voter’s <span class="code">WardBossId</span>. But this generated function will be especially useful in templates, where we’ll be able to write code like:</p>

<pre>{{ voter.ward_boss.name }}
</pre>
<p>Of course, we haven’t even defined a model file for Ward Bosses yet! Let’s go ahead and make it. Open a new file called <span class="code">model/ward_boss.erl</span>, and put this in it:</p>

<pre>-module(ward_boss, [Id, Name]).
-compile(export_all).
-has({voters, many}).
</pre>
<p>Now we’ve made an Ward Boss’s voters available in a function called <span class="code">voters()</span>, and in our templates we’ll be able to write code like</p>

<pre>{% for voter in ward_boss.voters %} ... {% endfor %}
</pre>
<p>Associations make <span class="caps">MVC</span> programming much, 
much easier. Of course, if you’ve seen this stuff before, you’ve 
probably been trained to worry about how many database calls we’re 
making under the hood, whether we’re prefetching the data, how to 
minimize database requests, etc. If that describes your thought 
processes, then <em>stop it!</em> I can’t say this enough: with Chicago Boss, database requests aren’t <em>quite</em> free, but they’re damn cheap. There’s no sense in counting queries at this point.</p>
<p>Anyway, before we start using these nifty <span class="code">belongs_to</span> and <span class="code">has</span> associations, let’s go ahead and let our Ward Bosses log in to the system, shall we?</p>
<p><a name="wiki-logins"></a><br></p><h3>II.8. How To Implement Log-ins</h3>
<p>We’re about to build a real log-in and session system, not just a 
kid’s little plaything. I’m going to go a little bit faster and not 
comment on every single line of code we paste in, so boys and girls, 
hold on to your hats.</p>
<p>The first thing we want to do is add an attribute for each Ward Boss’s password. Open up <span class="code">model/ward_boss.erl</span> and add <span class="code">PasswordHash</span>
 to the list of attributes.  (Since there aren’t that many aldermen, 
we’ll let them use their real names to log in.) The first line should 
now look like this:</p>

<pre>-module(ward_boss, [Id, Name, PasswordHash]).
</pre>
<p>Next we’re going to add some logic for recognizing that a Ward Boss 
is logged into a session, and a function for checking passwords. Add 
these lines to the <span class="code">model/ward_boss.erl</span> file:</p>

<pre>-define(SECRET_STRING, "Not telling secrets!").

session_identifier() -&gt;
    mochihex:to_hex(erlang:md5(?SECRET_STRING ++ Id)).

check_password(Password) -&gt;
    Salt = mochihex:to_hex(erlang:md5(Name)),
    user_lib:hash_password(Password, Salt) =:= PasswordHash.

login_cookies() -&gt;
    [ mochiweb_cookies:cookie("user_id", Id, [{path, "/"}]),
        mochiweb_cookies:cookie("session_id", session_identifier(), [{path, "/"}]) ].
</pre>
<p>Here’s the strategy: when a log-in is successful, we’ll put that session identifier along with the <span class="code">Id</span>
 into a cookie, and if we ever receive that same cookie back, we’ll know
 it’s the same person who logged in. No one will be able to forge 
sessions without knowing the secret string. So don’t tell anyone what it
 is!</p>
<p>Chicago Boss ships with mochiweb and its associated libraries. The function <span class="code">mochihex:to_hex/1</span> just turns an integer into a hex string, and <span class="code">mochiweb_cookies:cookie/3</span> generates an <span class="caps">HTTP</span> Set-Cookie header. If you want, you can check out the other utility functions in the <span class="code">src/mochiweb</span> directory. We’ll be seeing these functions again before it’s all over.</p>
<p>Next let’s write a little log-in page. Create a directory in <span class="code">view</span> called <span class="code">user</span>, and open a new file called <span class="code">view/user/login.html</span>. Put this into it:</p>

<pre>{% if error %}
&lt;font color="red"&gt;{{ error }}&lt;/font&gt;
{% endif %}
&lt;form method="post"&gt;
Name:&lt;br /&gt;
&lt;input name="name" /&gt;&lt;br /&gt;&lt;br /&gt;

Password:&lt;br /&gt;
&lt;input name="password" type="password" /&gt;&lt;br /&gt;&lt;br /&gt;

&lt;input type="submit" value="Log in" /&gt;
&lt;input type="hidden" name="redirect" value="{{ redirect|default_if_none:"/voter/list" }}" /&gt;
&lt;/form&gt;
</pre>
<p>(If you have a flair for design, I’m sure you can do better.) Note 
that we have a hidden field here for redirecting the user; this is 
useful in cases where we want to redirect the user depending on how they
 arrived at the log-in page. Save and close.</p>
<p>Now it’s time for the glue code: the controller. For starters, let’s make a function for the <span class="code">login</span>
 action. We’ll make use of Erlang’s pattern-matching to distinguish the 
case when the user is loading the log-in page and when they’re sending 
us log-in data. To get started, open a new file called <span class="code">controller/user_controller.erl</span> and add this at the top:</p>

<pre>-module(user_controller, [Req]).
-compile(export_all).
</pre>
<p>(Nothing different from what we saw in <span class="code">voter_controller.erl</span>.) Now add the following to <span class="code">controller/user_controller.erl</span>:</p>
<pre>login('GET', []) -&gt;
    {ok, [{redirect, Req:header(referer)}]};
</pre>
    <p>Here we’re supplying the form with the <span class="caps">URL</span> of the page that the user came from, which is stored in the “Referer” <span class="caps">HTTP</span> header. We get access to the headers through <span class="code">Req</span>, which as mentioned is a SimpleBridge request object with all sorts of goodies. In just a second we’ll use it to access <span class="caps">POST</span> parameters.</p>
    <p>Now for the “hard” part, processing login credentials. If the 
password checks out, we’ll set the login cookies and redirect the user; 
otherwise, we’ll return some kind of error. Add this:</p>
<pre>login('POST', []) -&gt;
    Name = Req:post_param("name"),
    case boss_db:find(ward_boss, [{name, Name}], 1) of
        [WardBoss] -&gt;
            case WardBoss:check_password(Req:post_param("password")) of
                true -&gt;
                    {redirect, proplists:get_value("redirect",
                        Req:post_params(), "/"), WardBoss:login_cookies()};
                false -&gt;
                    {ok, [{error, "Bad name/password combination"}]}
            end;
        [] -&gt;
            {ok, [{error, "No Ward Boss named " ++ Name}]}
    end.
</pre>
    <p>Save and close. We’re not <em>quite</em> done here. Back in our model file we referred to a function called <span class="code">user_lib:hash_password/1</span>, which we haven’t actually written yet. Create a file called <span class="code">lib/user_lib.erl</span> and put this into it:</p>

<pre>-module(user_lib).
-compile(export_all).

hash_password(Password, Salt) -&gt;
    mochihex:to_hex(erlang:md5(Salt ++ Password)).

hash_for(Name, Password) -&gt;
    Salt = mochihex:to_hex(erlang:md5(Name)),
    hash_password(Password, Salt).
</pre>
    <p>Save and close. We are almost ready to start logging in users. 
Let’s go back to our voter list page and add a log-in link. Add this 
line to the top of <span class="code">view/voter/list.html</span>:</p>

<pre>&lt;p&gt;&lt;a href="/user/login"&gt;Log in&lt;/a&gt;&lt;/p&gt;
</pre>
    <p>Save and close. Now we just need a user! Let’s cheat and add it through the <span class="code">/admin</span> interface. Navigate to:</p>
<code>http://localhost:8001/admin/model/ward_boss</code>
    <p>Click “New ward_boss”. All we need to do is enter a name and a… password hash? Where do we get that?</p>
    <p>Not to worry—go back to the Chicago Boss shell, the one with all the <span class="caps">PROGRESS</span> REPORTs that we did all the work in before. Type:</p>

<pre>user_lib:hash_for("Bathhouse John", "password").
</pre>
<p>That command will give you a password hash for the name “Bathhouse 
John” and the password “password”. Paste that hash (without the quotes, 
dummy) into the <span class="code">/admin</span> form along with the name “Bathhouse John”, and then click “Create ward_boss”</p>
<p>Now we should have a user we can log in with. Let’s test it out. Go back to the voter list page:</p>

<pre>http://localhost:8001/voter/list</pre>
<p>Click the “Log in” link we created just a minute ago. Now attempt to 
log in as Bathhouse John. If all is well, you should be redirected to 
the voter list page; otherwise, you should get an error in red at the 
top.</p>
<p>Ok, now what? Well, the problem is that we’re not really using the 
login information. The next step is to protect our precious voter list, 
and maybe add a welcome message for the Ward Boss. We don’t want nobody 
nobody sent, now do we?</p>
<p><a name="wiki-login-info"></a><br></p><h3>II.9. How To Actually Use Log-In Information</h3>
<p>First things first: protect the voter list! Open up <span class="code">controller/voter_controller.erl</span> and add this as the first function:</p>

<pre>before_(_) -&gt;
    user_lib:require_login(Req).
</pre>
<p>Before executing an action, Chicago Boss checks to see if the controller has an <span class="code">before_</span> function. If so, it passes the action name to the <span class="code">before_</span> function and checks the return value. If Boss gets a return value of <span class="code">{ok, Credentials}</span>, it proceeds to execute the action, <em>and it passes <span class="code">Credentials</span> as the third argument to the action</em>. If Boss instead gets <span class="code">{redirect, Location}</span>, it redirects the user without executing the action at all. Note that if an action only takes two arguments, the <span class="code">before_</span> step is skipped altogether.</p>
<p>So to ensure <span class="code">before_</span> is invoked, we need to modify the actions to take a third argument. Modify the controller’s function definitions like so:<br></p><p>From:</p>
<pre>list('GET', [], WardBoss) -&gt;
</pre>
<p>To:</p>
<pre>view('GET', [VoterId], WardBoss) -&gt;
</pre>
<p>When we’re finished, these functions will have access to the BossRecord of the currently logged-in user (<span class="code">WardBoss</span>). But for now, just save and close, because we need to define the <span class="code">require_login/1</span> logic.</p>
<p>Open up <span class="code">lib/user_lib.erl</span> and add the following:</p>

<pre>require_login(Req) -&gt;
    case Req:cookie("user_id") of
        undefined -&gt; {redirect, "/user/login"};
        Id -&gt;
            case boss_db:find(Id) of
                undefined -&gt; {redirect, "/user/login"};
                WardBoss -&gt;
                    case WardBoss:session_identifier() =:= Req:cookie("session_id") of
                        false -&gt; {redirect, "/user/login"};
                        true -&gt; {ok, WardBoss}
                    end
            end
     end.
</pre>
<p>That’s all there is to it. Save and close. Not only is the voter list
 now password-protected, but we can replace the log-in link with a 
welcome message. Open up <span class="code">view/voter/list.html</span> and change the first line to:</p>

<pre>&lt;p&gt;How The Kids, {{ ward_boss.name }}?&lt;/p&gt;
</pre>
<p>All that’s left is the glue code. Open up <span class="code">controller/voter_controller.erl</span> and change the list function to:</p>

<pre>list('GET', [], WardBoss) -&gt;
    Voters = boss_db:find(voter, []),
    {ok, [{voters, Voters}, {ward_boss, WardBoss}]}.
</pre>
<p>Save and close, and mosey on over to:</p>
<p><code>http://localhost:8001/voter/list</code></p>
<p>If everything worked, the page should now inquire after the 
well-being of your progeny. We can use the log-in information to do more
 than show a welcome message, of course; before it’s over we’ll be 
showing each Ward Boss only the voters in their own ward. But first we 
want them able to submit voter information for themselves. To do that, 
we need to know how to validate input.</p>
<p><a name="wiki-validate"></a><br></p><h3>II.10. How To Validate Input</h3>
<p>We’ve already seen a simple example of validating input when we 
checked the username and password against the database. But we what if 
we want to check a form and report all of its errors at once? As it 
turns out, Erlang’s language features make it extremely easy to define a
 list of tests and collect all the tests that fail. We’ll go through a 
simple example as we build a voter registration form.</p>
<p>To start out, let’s write the form, including a little logic for displaying errors. Open a new file called <span class="code">view/voter/register.html</span> and put into it:</p>

<pre>{% if errors %}
&lt;ol&gt;
{% for error in errors %}
&lt;li&gt;&lt;font color=red&gt;{{ error }}&lt;/font&gt;
{% endfor %}
&lt;/ol&gt;
{% endif %}

&lt;form method="post"&gt;
First and last name:&lt;br /&gt;
&lt;input name="first_name" value="{{ voter.first_name|default_if_none:"" }}" /&gt;
&lt;input name="last_name" value="{{ voter.last_name|default_if_none:"" }}" /&gt;&lt;br /&gt;&lt;br /&gt;

Address&lt;br /&gt;
&lt;textarea name="address"&gt;{{ voter.address|default_if_none:"" }}&lt;/textarea&gt;&lt;br /&gt;&lt;br /&gt;

Notes&lt;br /&gt;
&lt;textarea name="notes"&gt;{{ voter.notes|default_if_none:"" }}&lt;/textarea&gt;&lt;br /&gt;&lt;br /&gt;

&lt;input type="submit" value="Submit form" /&gt;
&lt;/form&gt;
</pre>
<p>Next let’s add some validation code to the model. As of v0.3.3, 
Chicago Boss has some built-in validation machinery. To add tests, we 
need to add a function called <span class="code">voter:validation_tests/0</span> which returns a list of <span class="code">{TestMessage, TestFunction}</span> tuples. The <span class="code">TestFunction</span> will be a fun of arity 0. You’ll see in a second. Open up <span class="code">model/voter.erl</span> and add the following:</p>

<pre>validation_tests() -&gt;
    [{fun() -&gt; length(FirstName) &gt; 0 end,
            "Please enter a first name"},
        {fun() -&gt; length(LastName) &gt; 0 end,
            "Please enter a last name"},
        {fun() -&gt; string:str(Address, "Chicago") &gt; 0 end,
            "Address is not in Chicago! What good is that??"}].
</pre>
<p>That’s all we need to do in the model. If any of these tests fail, we’ll get a list of errors when trying to save the record.</p>
<p>Finally, we modify the controller code, <span class="code">controller/voter_controller.erl</span>. Add this:</p>

<pre>register('GET', [], WardBoss) -&gt;
    {ok, []};
register('POST', [], WardBoss) -&gt;
    Voter = voter:new(id, Req:post_param("first_name"), Req:post_param("last_name"),
        Req:post_param("address"), Req:post_param("notes"), WardBoss:id()),
    case Voter:save() of
        {ok, SavedVoter} -&gt; 
            {redirect, "/voter/view/"++SavedVoter:id()};
        {error, Errors} -&gt;
           {ok, [{errors, Errors}, {voter, Voter}]}
    end.
</pre>
<p>And we’re done. It might seem weird that we return <span class="code">ok</span> when there are errors, but we’re just telling Chicago Boss that we’ve got everything under control.</p>
<p>Try out the new feature by pointing your browser to:</p>

<pre>http://localhost:8001/voter/register</pre>
<p>For kicks, type in a voter who’s not in Chicago and see what happens.
 Then try one with an address in Chicago. If everything works, it should
 take you to our beautiful voter information page. If so, 
congratulations! You are now processing and validating user input!</p>
<p>Now we’re in a position to really take advantage of the log-in 
information. Let’s change the voter list to show only voters registered 
by the person who is logged in. Surprisingly, we’ll end up <em>removing</em> more code than we add!</p>
<p>First open up <span class="code">view/voter/list.html</span>, and change this line:</p>

<pre>{% for voter in voters %}
</pre>
<p>To:</p>

<pre>{% for voter in ward_boss.voters %}
</pre>
<p>Also, while we’re there, add a link to the voter registration page to the bottom:</p>

<pre>&lt;p&gt;&lt;a href="/voter/register"&gt;Register a new voter&lt;/a&gt;&lt;/p&gt;
</pre>
<p>Save and close. Next open up <span class="code">controller/voter_controller.erl</span>. Rip out the current implementation of <span class="code">list</span> and replace it with:</p>

<pre>list('GET', [], WardBoss) -&gt;
    {ok, [{ward_boss, WardBoss}]}.
</pre>
<p>Rather than search the database ourselves, we take advantage of the <span class="code">has</span> association and do all the querying that way. Point your browser back to:</p>

<pre>http://localhost:8001/voter/list</pre>
<p>You should just see the voters that you created through your form, and none of the voters we made with the <span class="code">/admin</span> interface. Go ahead and create a couple more voters using your applicatin. You made it, now play with it!</p>
<p><a name="wiki-logout"></a><br></p><h3>II.11. How To Implement A Log-Out</h3>
<p>One feature we’re still missing is the feature a real Ward Boss from Chicago will want most: the ability to cover his tracks!</p>
<p>First let’s provide a log-out link next to our welcome message. Change the first line of <span class="code">view/voter/list.html</span> to this:</p>

<pre>&lt;p&gt;How The Kids, {{ ward_boss.name }}? (&lt;a href="/user/logout"&gt;Quick, Log Me Out!&lt;/a&gt;)&lt;/p&gt;
</pre>
<p>The log-out link will just reset the user’s cookies and redirect 
somewhere, so we don’t need a new template file for it. Let’s pop open <span class="code">controller/user_controller.erl</span> and add a new function:</p>

<pre>logout('GET', []) -&gt;
    {redirect, "/",
        [ mochiweb_cookies:cookie("user_id", "", [{path, "/"}]),
            mochiweb_cookies:cookie("session_id", "", [{path, "/"}]) ]}.
</pre>
<p>That will redirect to the homepage and blank out the credential cookies. Go ahead and try it out. Refresh the voter list page (<code>/voter/list</code>) and click “Quick, Log Me Out!”</p>
<p>Ah, back to the home page. I guess that nearly concludes our guided 
tour. At this point we have a full-fledged log-in app. Now all we need 
is some kind of <span class="caps">RSS</span> feed…</p>
<p><a name="wiki-rss-feed"></a><br></p><h3>II.12. How To Implement an <span class="caps">RSS</span> feed</h3>
<p>You want to be notified about all those new voters, right?</p>
<p>We’re going to start by adding a <span class="code">CreationTime</span> attribute to the voter model so we can put that into the feed. Open up <span class="code">model/voter.erl</span> and change the first line to:</p>
<pre><p>-module(voter, [Id, FirstName, LastName, Address, Notes, WardBossId, CreationTime]).<br></p></pre>
<p>We don’t worry too much about migrating the data because Chicago Boss
 will automatically fill in blanks on the old data next time a 
particular record retrieved (and drop obsolete fields next time a 
particular record is updated). We might end up with some weird Year 0 
values in existing data, but we can deal.</p>
<p>Anyway, attributes that end in “Time” are treated specially; instead of passing a String to <span class="code">new</span>, we need to pass in either a DateTime tuple or an <span class="code">erlang:now()</span> object. Let’s modify the call to <span class="code">voter:new</span> in order to use <span class="code">erlang:now()</span> as the last argument. Open up <span class="code">controller/voter_controller.erl</span> and change these lines:<br><br></p><pre><br>
    Voter = voter:new(id, Req:post_param(“first_name”), Req:post_param(“last_name”),<br>
        Req:post_param(“address”), Req:post_param(“notes”), WardBoss:id()),<br></pre><br><p>To:</p>
<pre>    Voter = voter:new(id, Req:post_param("first_name"), Req:post_param("last_name"),
        Req:post_param("address"), Req:post_param("notes"), WardBoss:id(), erlang:now()),
</pre>
<p>Now we can get busy with the <span class="caps">RSS</span> feed. Open up a new template called <span class="code">view/voter/rss.html</span> (don’t worry about the .html extension, we’ll get the <span class="caps">MIME</span> type right in a minute). You might be accustomed to fancy <span class="caps">RSS</span> generation tools, but forget it, it’s easy enough to get things done the old-fashioned way so here we go. Just paste this in:</p>

<pre>{% autoescape on %}&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" 
        xmlns:dc="http://purl.org/dc/elements/1.1/"&gt;
   &lt;channel&gt;
   &lt;title&gt;Chicago Votes&lt;/title&gt;
   &lt;atom:link href="http://localhost:8001/voter/rss" rel="self" type="application/rss+xml" /&gt;
   &lt;link&gt;http://localhost:8001/voter/list&lt;/link&gt;
   &lt;description&gt;All the folks that's fit to vote!&lt;/description&gt;
   &lt;language&gt;en-us&lt;/language&gt;
   {% for voter in voters %}
   {% if forloop.first %}
   &lt;lastBuildDate&gt;{{ voter.creation_time|date:"r" }}&lt;/lastBuildDate&gt;
   {% endif %}
       &lt;item&gt;
           {% if voter.ward_boss %}
           &lt;dc:creator&gt;{{ voter.ward_boss.name }}&lt;/dc:creator&gt;
           {% endif %}
           &lt;guid isPermaLink="true"&gt;http://localhost:8001/voter/view/{{ voter.id }}&lt;/guid&gt;
           &lt;link&gt;http://localhost:8001/voter/view/{{ voter.id }}&lt;/link&gt;
           &lt;title&gt;{{ voter.first_name }} {{ voter.last_name }}&lt;/title&gt;
           &lt;description&gt;{{ voter.notes }}&lt;/description&gt;
           &lt;pubDate&gt;{{ voter.creation_time|date:"r" }}&lt;/pubDate&gt;
       &lt;/item&gt;
   {% endfor %}
   &lt;/channel&gt;
&lt;/rss&gt;{% endautoescape %}
</pre>
<p>Notice the <span class="code">date</span> filter applied to <span class="code">voter.creation_time</span>. This filter makes our lives a hundred times easier in terms of generating an <span class="caps">RFC</span>-822 timestamp, so I kind of lied when I said we didn’t have fancy <span class="caps">RSS</span> generation tools.</p>
<p>Now we just need to get it glued up. Open up <span class="code">controller/voter_controller.erl</span> and add an action. For now we won’t worry about authentication since most <span class="caps">RSS</span> feeds are pretty much a secret anyhow.</p>

<pre>rss('GET', []) -&gt;
    Voters = boss_db:find(voter, [], 20, 0, creation_time, num_descending),
    {ok, [{voters, Voters}]}.
</pre>
<p>Internally, dates are stored as integers, so we want to sort numerically (i.e. <span class="code">num_descending</span>). This is the most complicated call to <span class="code">boss_db:find</span> that we’ve yet seen, but you can find the full documentation for it over in the <a href="http://www.chicagoboss.org/api.html">Chicago Boss <span class="caps">API</span> docs</a>.</p>
<p>Point your browser over to the new <span class="caps">RSS</span> feed to see what it looks like:</p>
<p><code>http://localhost:8001/voter/rss</code></p>
<p>Neat, huh? Now I’m sure you’re thinking, <span class="caps">WAIT</span>, <span class="caps">WHAT</span> <span class="caps">ABOUT</span> <span class="caps">THE</span> <span class="caps">MIME</span> <span class="caps">TYPE</span>?? I almost forgot. Change the last line of that <span class="code">rss</span> function to:</p>

<pre>    {ok, [{voters, Voters}],  [{"Content-Type", "application/rss+xml"}]}.
</pre>
<p>We send Boss additional <span class="caps">HTTP</span> headers to return to the client in the third tuple element of the return value, so that’s all we need to do to get the <span class="caps">MIME</span> type right.</p>
<p>Done!</p>
<p>You’re on your own now, kid. To see the (growing) list of other things you can do with Boss, check out the <a href="http://www.chicagoboss.org/api.html">Chicago Boss <span class="caps">API</span> docs</a>, and if you want to connect with other Boss users, be sure to join the <a href="http://groups.google.com/group/chicagoboss">Chicago Boss mailing list</a>.</p>
<h2>Part <span class="caps">III</span>. The Future Of Chicago Boss</h2>
<div class="quote">
<p>“Says who?” “Says Boss.”</p>
</div>
<p>This guide has covered most of the state of the art of Chicago Boss. 
It’s a simple framework that packs a powerful punch. Although there’s 
still a lot of work to be done, I think the design of Boss will make 
future improvements quite easy.</p>
<p>One class of improvements relates to deployment, code upgrades, and monitoring. I wrote Boss to work on a tiny <span class="caps">VPS</span>
 rather than a huge server cluster, so it’s not a big issue for me 
personally. But given that Chicago Boss is built with Erlang, it should 
be possible to upgrade code on the fly with no down-time if somebody 
writes the right scripts. However, it’s not there yet.</p>
<p>As you probably noticed during this tour, the <span class="code">/admin</span>
 interface could use a lot of love. I wrote it in a couple hours, and 
besides needing aesthetic improvement, it needs to be able to edit 
records and deal with Time and ForeignId fields more intelligently. And 
sort the search results.</p>
<p>Fourth, Boss needs a module for doing A/B testing. What I’d really 
like to see with Boss is a module that implements Bayesian experimental 
design, which <a href="https://github.com/evanmiller/ChicagoBoss/wiki/how-not-to-run-an-ab-test.html">avoids some of the problems associated with traditional A/B tests</a>.
 It’d be even better if Chicago Boss decided for you whether A or B was 
better and then emailed you a patch getting rid of the losing code.</p>
<p>Fifth, I’d like to see some kind of integration with <a href="http://nitrogenproject.com/">Nitrogen</a>.
 Nitrogen’s magic is mostly on the front-end, whereas Boss really shines
 on the backend. Both Boss and Nitrogen are housed in Rusty Klophaus’s 
excellent SimpleBridge, so they ought to fit together quite well. I’ve 
even thought of an irresistible name for the project: <em><span class="caps">BOSS</span> IN <span class="caps">SPACE</span>!!</em></p>
<p>If you might want to get involved in the development of Chicago Boss,
 or keep up with Chicago Boss news and updates, or just have a couple 
Chicago Boss questions, the best thing to do is <a href="http://groups.google.com/group/chicagoboss">join the new Chicago Boss mailing list</a>.</p>
<p><a name="wiki-meet-tyrant"></a><br></p><h2>Appendix A: Meet The Tyrant</h2>
<p>Chicago Boss is compatible with one and only one database server: <a href="http://1978th.net/tokyotyrant/">Tokyo Tyrant</a>.
 Unfortunately, Tokyo Tyrant isn’t yet available with a simple 
“apt-get,” so this section will go through the details of setting up a 
Tyrant server on a Mac or Linux machine. It might be the hardest part of
 the whole guide.</p>
<p>I am told that Mac users can install both Cabinet and Tyrant via <a href="http://www.macports.org/">MacPorts</a>.</p>
<p><a name="wiki-download-cabinet"></a><br></p><h4>A.1. Download and Install Tokyo Cabinet</h4>
<p>Tokyo Tyrant requires a software library called <a href="http://fallabs.com/tokyocabinet/">Tokyo Cabinet</a>.</p>
<p><em>Mac/Linux:</em></p>

<pre>    wget http://fallabs.com/tokyocabinet/tokyocabinet-1.4.47.tar.gz
    tar xzf tokyocabinet-1.4.47.tar.gz
    cd tokyocabinet-1.4.47
    ./configure
    make
    sudo make install
</pre>
<p><a name="wiki-download-tyrant"></a><br></p><h4>A.2. Download and Install Tokyo Tyrant</h4>
<p>Now we’re ready for the Tyrant.</p>
<p><em>Mac and Linux:</em></p>

<pre>    wget http://fallabs.com/tokyotyrant/tokyotyrant-1.1.41.tar.gz
    tar xzf tokyotyrant-1.1.41.tar.gz
    cd tokyotyrant-1.1.41
    ./configure
    make
    sudo make install
</pre>
<p>If everything went smoothly, Tokyo Tyrant is now installed on your 
system. To get it up and running in your home directory, just do</p>

<pre>   cd ~
   ttserver -log ttserver.log boss-test.tct
</pre>
<p>That will create a table database called <span class="code">boss-test.tct</span> right in your home directory, along with a log file called <span class="code">ttserver.log</span>.
 You can stop the database at any time with Control-C. This setup will 
work fine for now, but if you’re planning to do serious development, you
 will want Tokyo Tyrant running as a daemon under its own username with 
files in its own directory. The following section will explain how to do
 that.</p>
<h4>A.3. Configure Boss To Use Tyrant</h4>
<p>Open up <span class="code">boss.config</span> and change this line:</p>

<pre>    {db_driver, boss_db_driver_mock},
</pre>
<p>To this:</p>
<div class="terminal">
{db_driver, boss_db_driver_tyrant},
</div>
<p>You can also set additional database options <span class="code">db_host</span> and <span class="code">db_port</span> if you have a non-standard configuration.</p>
<p><a name="wiki-configure-tyrant"></a><br></p><h4>A.4. Configure Tyrant As A Standalone Daemon (Optional, Ubuntu only)</h4>
<p>First, create a user for Tokyo Tyrant:</p>

<pre>sudo adduser --system --no-create-home --group ttserver
</pre>
<p>Next create the three directories that Tyrant will write files in:</p>

<pre>    sudo mkdir /var/run/ttserver&lt;br /&gt;
    sudo mkdir /var/lib/ttserver&lt;br /&gt;
    sudo mkdir /var/log/ttserver&lt;br /&gt;
    sudo chown ttserver:ttserver /var/*/ttserver&lt;br /&gt;
</pre>
<p>Finally, Tyrant will need its own init.d script so that it 
automatically starts up when the computer boots. Here’s the script I 
use, just save it to <span class="code">/etc/init.d/ttserver</span>:</p>
<p><a href="https://github.com/evanmiller/ChicagoBoss/wiki/ttserver">Download my <span class="code">/etc/init.d/ttserver</span></a></p>
<p>Try out the script by starting up Tyrant:</p>

<pre>sudo /etc/init.d/ttserver start
</pre>
<p>If everything seemed to work, we need to tell the system that we want this script to be run at startup and shutdown. Do it with:</p>

<pre>sudo update-rc.d ttserver defaults
</pre>
<p>Congratulations. You now own your very own Tyrant.</p>
<p><a name="wiki-changes"></a><br></p><h2>Appendix B: Changelog</h2><br><ul>
<br><li>March 8, 2012: Update to Chicago Boss 0.7.2</li>
<br><li>February 28, 2011: Update to Chicago Boss 0.4.5; fix bug in SavedGreeting command; add note about enabling <span class="caps">SSL</span> via MacPorts</li>
<br><li>September 7, 2010: Update to Chicago Boss 0.4.0 (Tyrant is optional; Web/ is abolished)</li>
<br><li>June 21, 2010: Bugfix: “has_many” is supposed to be “has”</li>
<br><li>June 15, 2010: Update to Chicago Boss 0.3.6 (views and controllers are now in the Web/ directory)</li>
<br><li>May 27, 2010: Update <span class="code">save()</span> semantics; use new model validation mechanism; update to ChicagoBoss 0.3.3.</li>
<br><li>May 22, 2010: Update to ChicagoBoss 0.3.2; rewrite introduction</li>
<br><li>May 20, 2010: Break “Chicago Boss’s Big Secret” into a separate article</li>
<br><li>April 30, 2010: Install Tokyo Cabinet from sources on Linux (<span class="code">apt-get</span> provides wrong version); update <span class="code">wget</span> command to ChicagoBoss-0.3.1 to prevent problems issuing DB commands before loading the “Hello, World!” page</li>
<br><li>April 29, 2010: Initial draft</li>
</ul>
    </div>
  </div>
  </div>

</div>
<div id="gollum-footer">
  <p id="last-edit">
    Last edited by kotedo, <time class="js-relative-date" datetime="2012-05-18T06:47:52-07:00" title="2012-05-18 06:47:52">2 months ago</time>
  </p>
  <p id="delete-link">
    <a href="https://github.com/evanmiller/ChicagoBoss/wiki/An-Evening-With-Chicago-Boss" data-confirm="Are you sure you want to delete this page?" data-method="delete"><span>Delete this Page</span></a>
  </p>
</div>
</div>


        </div>
      </div>
      <div class="context-overlay"></div>
    </div>

      <div id="footer-push"></div><!-- hack for sticky footer -->
    </div><!-- end of wrapper - hack for sticky footer -->

      <!-- footer -->
      <div id="footer">
        
  <div class="upper_footer">
     <div class="container clearfix">

       <!--[if IE]><h4 id="blacktocat_ie">GitHub Links</h4><![endif]-->
       <!--[if !IE]--><h4 id="blacktocat">GitHub Links</h4><!--[endif]-->

       <ul class="footer_nav">
         <h4>GitHub</h4>
         <li><a href="https://github.com/about">About</a></li>
         <li><a href="https://github.com/blog">Blog</a></li>
         <li><a href="https://github.com/features">Features</a></li>
         <li><a href="https://github.com/contact">Contact &amp; Support</a></li>
         <li><a href="https://github.com/training">Training</a></li>
         <li><a href="http://enterprise.github.com/">GitHub Enterprise</a></li>
         <li><a href="http://status.github.com/">Site Status</a></li>
       </ul>

       <ul class="footer_nav">
         <h4>Clients</h4>
         <li><a href="http://mac.github.com/">GitHub for Mac</a></li>
         <li><a href="http://windows.github.com/">GitHub for Windows</a></li>
         <li><a href="http://eclipse.github.com/">GitHub for Eclipse</a></li>
         <li><a href="http://mobile.github.com/">GitHub Mobile Apps</a></li>
       </ul>

       <ul class="footer_nav">
         <h4>Tools</h4>
         <li><a href="http://get.gaug.es/">Gauges: Web analytics</a></li>
         <li><a href="http://speakerdeck.com/">Speaker Deck: Presentations</a></li>
         <li><a href="https://gist.github.com/">Gist: Code snippets</a></li>

         <h4 class="second">Extras</h4>
         <li><a href="http://jobs.github.com/">Job Board</a></li>
         <li><a href="http://shop.github.com/">GitHub Shop</a></li>
         <li><a href="http://octodex.github.com/">The Octodex</a></li>
       </ul>

       <ul class="footer_nav">
         <h4>Documentation</h4>
         <li><a href="http://help.github.com/">GitHub Help</a></li>
         <li><a href="http://developer.github.com/">Developer API</a></li>
         <li><a href="http://github.github.com/github-flavored-markdown/">GitHub Flavored Markdown</a></li>
         <li><a href="http://pages.github.com/">GitHub Pages</a></li>
       </ul>

     </div><!-- /.site -->
  </div><!-- /.upper_footer -->

<div class="lower_footer">
  <div class="container clearfix">
    <!--[if IE]><div id="legal_ie"><![endif]-->
    <!--[if !IE]--><div id="legal"><!--[endif]-->
      <ul>
          <li><a href="https://github.com/site/terms">Terms of Service</a></li>
          <li><a href="https://github.com/site/privacy">Privacy</a></li>
          <li><a href="https://github.com/security">Security</a></li>
      </ul>

      <p>© 2012 <span title="0.12739s from fe14.rs.github.com">GitHub</span> Inc. All rights reserved.</p>
    </div><!-- /#legal or /#legal_ie-->

      <div class="sponsor">
        <a href="http://www.rackspace.com/" class="logo">
          <img alt="Dedicated Server" src="An-Evening-With-Chicago-Boss_files/rackspaces_logo.png" height="36" width="38">
        </a>
        Powered by the <a href="http://www.rackspace.com/">Dedicated
        Servers</a> and<br> <a href="http://www.rackspacecloud.com/">Cloud
        Computing</a> of Rackspace Hosting<span>®</span>
      </div>
  </div><!-- /.site -->
</div><!-- /.lower_footer -->

      </div><!-- /#footer -->

    

<div id="keyboard_shortcuts_pane" class="instapaper_ignore readability-extra" style="display:none">
  <h2>Keyboard Shortcuts <small><a href="#" class="js-see-all-keyboard-shortcuts">(see all)</a></small></h2>

  <div class="columns threecols">
    <div class="column first">
      <h3>Site wide shortcuts</h3>
      <dl class="keyboard-mappings">
        <dt>s</dt>
        <dd>Focus site search</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>?</dt>
        <dd>Bring up this help dialog</dd>
      </dl>
    </div><!-- /.column.first -->

    <div class="column middle" style="display:none">
      <h3>Commit list</h3>
      <dl class="keyboard-mappings">
        <dt>j</dt>
        <dd>Move selection down</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>k</dt>
        <dd>Move selection up</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>c <em>or</em> o <em>or</em> enter</dt>
        <dd>Open commit</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>y</dt>
        <dd>Expand URL to its canonical form</dd>
      </dl>
    </div><!-- /.column.first -->

    <div class="column last" style="display:none">
      <h3>Pull request list</h3>
      <dl class="keyboard-mappings">
        <dt>j</dt>
        <dd>Move selection down</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>k</dt>
        <dd>Move selection up</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt>o <em>or</em> enter</dt>
        <dd>Open issue</dd>
      </dl>
      <dl class="keyboard-mappings">
        <dt><span class="platform-mac">⌘</span><span class="platform-other">ctrl</span> <em>+</em> enter</dt>
        <dd>Submit comment</dd>
      </dl>
    </div><!-- /.columns.last -->

  </div><!-- /.columns.equacols -->

  <div style="display:none">
    <div class="rule"></div>

    <h3>Issues</h3>

    <div class="columns threecols">
      <div class="column first">
        <dl class="keyboard-mappings">
          <dt>j</dt>
          <dd>Move selection down</dd>
        </dl>
        <dl class="keyboard-mappings">
          <dt>k</dt>
          <dd>Move selection up</dd>
        </dl>
        <dl class="keyboard-mappings">
          <dt>x</dt>
          <dd>Toggle selection</dd>
        </dl>
        <dl class="keyboard-mappings">
          <dt>o <em>or</em> enter</dt>
          <dd>Open issue</dd>
        </dl>
        <dl class="keyboard-mappings">
          <dt><span class="platform-mac">⌘</span><span class="platform-other">ctrl</span> <em>+</em> enter</dt>
          <dd>Submit comment</dd>
        </dl>
      </div><!-- /.column.first -->
      <div class="column last">
        <dl class="keyboard-mappings">
          <dt>c</dt>
          <dd>Create issue</dd>
        </dl>
        <dl class="keyboard-mappings">
          <dt>l</dt>
          <dd>Create label</dd>
        </dl>
        <dl class="keyboard-mappings">
          <dt>i</dt>
          <dd>Back to inbox</dd>
        </dl>
        <dl class="keyboard-mappings">
          <dt>u</dt>
          <dd>Back to issues</dd>
        </dl>
        <dl class="keyboard-mappings">
          <dt>/</dt>
          <dd>Focus issues search</dd>
        </dl>
      </div>
    </div>
  </div>

  <div style="display:none">
    <div class="rule"></div>

    <h3>Issues Dashboard</h3>

    <div class="columns threecols">
      <div class="column first">
        <dl class="keyboard-mappings">
          <dt>j</dt>
          <dd>Move selection down</dd>
        </dl>
        <dl class="keyboard-mappings">
          <dt>k</dt>
          <dd>Move selection up</dd>
        </dl>
        <dl class="keyboard-mappings">
          <dt>o <em>or</em> enter</dt>
          <dd>Open issue</dd>
        </dl>
      </div><!-- /.column.first -->
    </div>
  </div>

  <div style="display:none">
    <div class="rule"></div>

    <h3>Network Graph</h3>
    <div class="columns equacols">
      <div class="column first">
        <dl class="keyboard-mappings">
          <dt><span class="badmono">←</span> <em>or</em> h</dt>
          <dd>Scroll left</dd>
        </dl>
        <dl class="keyboard-mappings">
          <dt><span class="badmono">→</span> <em>or</em> l</dt>
          <dd>Scroll right</dd>
        </dl>
        <dl class="keyboard-mappings">
          <dt><span class="badmono">↑</span> <em>or</em> k</dt>
          <dd>Scroll up</dd>
        </dl>
        <dl class="keyboard-mappings">
          <dt><span class="badmono">↓</span> <em>or</em> j</dt>
          <dd>Scroll down</dd>
        </dl>
        <dl class="keyboard-mappings">
          <dt>t</dt>
          <dd>Toggle visibility of head labels</dd>
        </dl>
      </div><!-- /.column.first -->
      <div class="column last">
        <dl class="keyboard-mappings">
          <dt>shift <span class="badmono">←</span> <em>or</em> shift h</dt>
          <dd>Scroll all the way left</dd>
        </dl>
        <dl class="keyboard-mappings">
          <dt>shift <span class="badmono">→</span> <em>or</em> shift l</dt>
          <dd>Scroll all the way right</dd>
        </dl>
        <dl class="keyboard-mappings">
          <dt>shift <span class="badmono">↑</span> <em>or</em> shift k</dt>
          <dd>Scroll all the way up</dd>
        </dl>
        <dl class="keyboard-mappings">
          <dt>shift <span class="badmono">↓</span> <em>or</em> shift j</dt>
          <dd>Scroll all the way down</dd>
        </dl>
      </div><!-- /.column.last -->
    </div>
  </div>

  <div style="display:none">
    <div class="rule"></div>
    <div class="columns threecols">
      <div class="column first" style="display:none">
        <h3>Source Code Browsing</h3>
        <dl class="keyboard-mappings">
          <dt>t</dt>
          <dd>Activates the file finder</dd>
        </dl>
        <dl class="keyboard-mappings">
          <dt>l</dt>
          <dd>Jump to line</dd>
        </dl>
        <dl class="keyboard-mappings">
          <dt>w</dt>
          <dd>Switch branch/tag</dd>
        </dl>
        <dl class="keyboard-mappings">
          <dt>y</dt>
          <dd>Expand URL to its canonical form</dd>
        </dl>
      </div>
    </div>
  </div>

  <div style="display:none">
    <div class="rule"></div>
    <div class="columns threecols">
      <div class="column first">
        <h3>Browsing Commits</h3>
        <dl class="keyboard-mappings">
          <dt><span class="platform-mac">⌘</span><span class="platform-other">ctrl</span> <em>+</em> enter</dt>
          <dd>Submit comment</dd>
        </dl>
        <dl class="keyboard-mappings">
          <dt>escape</dt>
          <dd>Close form</dd>
        </dl>
        <dl class="keyboard-mappings">
          <dt>p</dt>
          <dd>Parent commit</dd>
        </dl>
        <dl class="keyboard-mappings">
          <dt>o</dt>
          <dd>Other parent commit</dd>
        </dl>
      </div>
    </div>
  </div>
</div>

    <div id="markdown-help" class="instapaper_ignore readability-extra">
  <h2>Markdown Cheat Sheet</h2>

  <div class="cheatsheet-content">

  <div class="mod">
    <div class="col">
      <h3>Format Text</h3>
      <p>Headers</p>
      <pre># This is an &lt;h1&gt; tag
## This is an &lt;h2&gt; tag
###### This is an &lt;h6&gt; tag</pre>
     <p>Text styles</p>
     <pre>*This text will be italic*
_This will also be italic_
**This text will be bold**
__This will also be bold__

*You **can** combine them*
</pre>
    </div>
    <div class="col">
      <h3>Lists</h3>
      <p>Unordered</p>
      <pre>* Item 1
* Item 2
  * Item 2a
  * Item 2b</pre>
     <p>Ordered</p>
     <pre>1. Item 1
2. Item 2
3. Item 3
   * Item 3a
   * Item 3b</pre>
    </div>
    <div class="col">
      <h3>Miscellaneous</h3>
      <p>Images</p>
      <pre>![GitHub Logo](/images/logo.png)
Format: ![Alt Text](url)
</pre>
     <p>Links</p>
     <pre>http://github.com - automatic!
[GitHub](http://github.com)</pre>
<p>Blockquotes</p>
     <pre>As Kanye West said:

&gt; We're living the future so
&gt; the present is our past.
</pre>
    </div>
  </div>
  <div class="rule"></div>

  <h3>Code Examples in Markdown</h3>
  <div class="col">
      <p>Syntax highlighting with <a href="http://github.github.com/github-flavored-markdown/" title="GitHub Flavored Markdown" target="_blank">GFM</a></p>
      <pre>```javascript
function fancyAlert(arg) {
  if(arg) {
    $.facebox({div:'#foo'})
  }
}
```</pre>
    </div>
    <div class="col">
      <p>Or, indent your code 4 spaces</p>
      <pre>Here is a Python code example
without syntax highlighting:

    def foo:
      if not bar:
        return true</pre>
    </div>
    <div class="col">
      <p>Inline code for comments</p>
      <pre>I think you should use an
`&lt;addr&gt;` element here instead.</pre>
    </div>
  </div>

  </div>



    <div id="ajax-error-message">
      <span class="mini-icon mini-icon-exclamation"></span>
      Something went wrong with that request. Please try again.
      <a href="#" class="ajax-error-dismiss">Dismiss</a>
    </div>

    <div id="logo-popup">
      <h2>Looking for the GitHub logo?</h2>
      <ul>
        <li>
          <h4>GitHub Logo</h4>
          <a href="http://github-media-downloads.s3.amazonaws.com/GitHub_Logos.zip"><img alt="Github_logo" src="An-Evening-With-Chicago-Boss_files/github_logo.png"></a>
          <a href="http://github-media-downloads.s3.amazonaws.com/GitHub_Logos.zip" class="minibutton btn-download download">Download</a>
        </li>
        <li>
          <h4>The Octocat</h4>
          <a href="http://github-media-downloads.s3.amazonaws.com/Octocats.zip"><img alt="Octocat" src="An-Evening-With-Chicago-Boss_files/octocat.png"></a>
          <a href="http://github-media-downloads.s3.amazonaws.com/Octocats.zip" class="minibutton btn-download download">Download</a>
        </li>
      </ul>
    </div>

    
    <span id="server_response_time" data-time="0.13029" data-host="fe14"></span>
  


</body></html>